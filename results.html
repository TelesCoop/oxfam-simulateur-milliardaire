<!DOCTYPE html>
<html lang="en" style="height: 100%">

<head>
    <meta charset="utf-8">
    <title>Oxfam - Comparez votre salaire avec celui d'un PDG français</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="robots" content="noindex">
    <link rel="stylesheet" href="css/oxfam.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js"></script>
    <script src="js/tmpl.min.js"></script>
    <script defer data-domain="oxfam-pdg-cac40.tlscp.fr" src="https://plausible.io/js/script.js"></script>
    <meta property="og:type"          content="website" />
    <meta property="og:title"         content="Oxfam - Comparez votre salaire avec celui d'un PDG français" />
    <meta property="og:description"   content="Je viens de comparer mon salaire avec celui d'un grand PDG français." />
    <meta property="og:image"         content="" />
</head>
<div id="fb-root"></div>
<body class="app-container">
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<div class="header">
    <a href="/" title="Page d'accueil">
        <img class="logo" src="images/oxfam_logo_text.png" alt="logo-oxfam" class="logo"
             srcset="images/oxfam_logo_text_2x.png 2x"/>
    </a>
</div>
<div class="container results-container">
    <div class='screen-wrapper'>
        <div class="results-block">
            <img src="images/avatar.png" class="logo-pdg" alt="logo-pdg" id="image-pdg"/>
            <div>
                <div class="text" >
                    <p>
                        <span id="pre-result-number"></span>
                        <span class="text-yellow is-bold" id="result-number"></span>
                        <span id="post-result-number"></span>
                    </p>
                    <p>
                        <span id="pre-result-date"></span>
                        <span class="text-yellow is-bold" id="result-date"></span>
                        <span id="post-result-date"></span>
                    </p>
                    <p>
                        <span id="main-message"></span>
                    </p>
                </div>
                <p>
                    La répartition des richesses créées au sein des grandes entreprises françaises est depuis des années
                    largement favorable aux
                    actionnaires et aux PDG, au détriment des salarié·e·s.
                    Pour un meilleur partage des richesses au sein des grandes entreprises, Oxfam France appelle à limiter
                    les écarts de salaire de
                    1 à 20 entre le plus haut salaire et le salaire médian.
                </p>
                <div class="social-wrapper">
                <span class="social-text">
                Partager votre résultat :
                </span>
                    <div>
                        <a href="https://www.facebook.com/sharer.php?u=https://www.oxfamfrance.org/climat-et-energie/secheresses-enjeu-gestion-eau-france/" class="bsb-link" target="_blank">
                            <img src="images/facebook.svg" role="presentation"></img>
                        </a>
                        <button onclick="onTweetButtonHandler()" class="default-btn" data-show-count="false">
                            <img src="images/twitter.svg" role="presentation"></img>
                        </button>
                    </div>
                </div>
                <div class="actions-col">
                    <a href="/" class="btn headline-text" alt="Retour">Retour </a>
                </div>
            </div>
        </div>

    </div>
</div>
</script>


<script type="application/javascript">

  let mainMsg = ""
  const DATE_FORMAT = 'DDD MMMM YYYY à HH:mm:ss';
  const SUNDAY = 0; // moment day index
  const SATURDAY = 6; // moment day index
  const WEEKENDS = [SATURDAY, SUNDAY];
  const START_HOUR = 8
  const START_DATE = new Date(2023, 0, 1)

  function computeDays(numberOfDays) {
    moment.locale("fr")
    let date = moment(START_DATE);
    const hours = numberOfDays - Math.floor(numberOfDays)
    let count = 0;

    while (count < numberOfDays) {
      date.add(1, 'day');
      if (WEEKENDS.includes(date.day())) {
        continue;
      }
      count++;
    }

    date = date.add(START_HOUR, 'hours')
    if (hours) {
      const computeHours = hours * 12
      date.add(computeHours, "hours")
    }
    return date.format(DATE_FORMAT)
  }

  let ratioSalaryDiff = 0
  let nbDaysDiff = null
  let enterpriseName = localStorage.getItem("enterpriseName")
  let pdgSalary = localStorage.getItem("pdgSalary")
  let pdgName = localStorage.getItem("pdgName")
  let userSalary = localStorage.getItem("userSalary") // in €
  let userSalaryNet = localStorage.getItem("userSalaryNet") // in €
  let pdgImg = localStorage.getItem("pdgImg")
  let isComputed = false

  function computeValues() {
    const salary = userSalary || userSalaryNet
    if (salary && pdgSalary) {

      ratioSalaryDiff = pdgSalary / salary
      nbDaysDiff = Math.round(((salary / pdgSalary) * 320) * 100) / 100

      if (ratioSalaryDiff > 1) {
        mainMsg += `Le PDG de ${enterpriseName}, ${pdgName}, gagne ${Math.round(ratioSalaryDiff)} fois votre rémunération par an.
          Après le ${computeDays(nbDaysDiff).toLowerCase()}, il a déjà gagné votre salaire annuel.`
        document.getElementById("pre-result-number").innerText = `Le PDG de ${enterpriseName}, ${pdgName}, `
        document.getElementById("result-number").innerText = `gagne ${Math.round(ratioSalaryDiff)} fois votre rémunération par an.`

        document.getElementById("pre-result-date").innerText = ``
        document.getElementById("result-date").innerText = `Après le ${computeDays(nbDaysDiff).toLowerCase()},`
        document.getElementById("post-result-date").innerText = ` il a déjà gagné votre salaire annuel.`

      }  else {
        mainMsg += `Félicitations, vous gagnez plus que le PDG de ${enterpriseName}, ${pdgName} ! Êtes-vous bien sûr·e que vous avez entré votre salaire correctement ?`
        document.getElementById("main-message").innerText = mainMsg
      }

      document.getElementById("image-pdg").src=`images/${pdgImg}`;

      const sharingText = `Le PDG de ${enterpriseName} gagne ${Math.round(ratioSalaryDiff)} fois ma rémunération par an. Après le ${computeDays(nbDaysDiff)} il a déjà gagné mon salaire annuel.`
      // Update tweet text
      document.title = sharingText
      // Update Facebook sharing title
      document.querySelector('meta[property="og:title"]').setAttribute("content", sharingText);
      isComputed = true
    }
  }

  const onTweetButtonHandler = () => {
    let text = encodeURI("Je viens de comparer mon salaire avec le PDG de " + enterpriseName)
    let hashtags = "#"
    let url = "&url=https://www.oxfamfrance.org/"
    let link = "https://twitter.com/intent/tweet?text=" + text + "&hashtags=" + hashtags + "&url=" + url
    window.open(link, '_blank').focus()
  }

  const onFacebookButtonHandler = () => {
    FB.ui({
      method: 'share',
      href: 'your-webpage.html',
    }, function(response){})
  }
  computeValues()
  if (!isComputed) window.location.assign("/")


</script>
</body>

</html>
